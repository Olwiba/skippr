# Skippr tmux configuration - optimized for mobile development (Gboard)

# PREFIX: .a (period then 'a')
# This avoids interfering with normal period typing
# Press . then a to enter command mode, then press a letter
unbind C-b
unbind C-a
set-option -g prefix .

# After prefix (.), 'a' enters the mobile command table
bind-key a switch-client -T mobile

# Pressing . twice sends actual period
bind-key . send-keys .

# Enable mouse support for mobile touch interactions
set -g mouse on

# Increase scrollback buffer size
set-option -g history-limit 100000

# Start window and pane numbering at 1 (easier to reach)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Status bar configuration
set -g status-style 'bg=colour235 fg=colour255'
set -g status-left '[#S] '
set -g status-right '#[fg=colour255]%H:%M %d-%b'
set -g status-left-length 20
set -g status-right-length 40

# Current window status
setw -g window-status-current-style 'fg=colour0 bg=colour2 bold'
setw -g window-status-current-format ' #I:#W#F '

# Other window status
setw -g window-status-style 'fg=colour255 bg=colour236'
setw -g window-status-format ' #I:#W#F '

# Pane border
set -g pane-border-style 'fg=colour238'
set -g pane-active-border-style 'fg=colour2'

# Reload config (prefix + r still works)
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Faster command sequences (no delay)
set -s escape-time 0

# Enable 256 colors
set -g default-terminal "screen-256color"

# Copy mode vim bindings
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# ===========================================
# Mobile key table (Gboard optimized)
# ===========================================
# ACTIVATION: .a (period, then 'a')
# Then press a single letter for the command
# All commands use only letters - easy on Gboard!
#
# CONTROL KEYS
bind-key -T mobile i send-keys C-c          # interrupt
bind-key -T mobile d send-keys C-d          # eof/exit
bind-key -T mobile z send-keys C-z          # suspend
bind-key -T mobile x send-keys C-l          # clear screen

# ESCAPE
bind-key -T mobile e send-keys Escape       # escape key

# LINE NAVIGATION  
bind-key -T mobile a send-keys C-a          # start of line
bind-key -T mobile f send-keys C-e          # end of line

# SEARCH
bind-key -T mobile r send-keys C-r          # reverse search

# VIM SHORTCUTS
bind-key -T mobile w send-keys Escape ':w' Enter    # save
bind-key -T mobile q send-keys Escape ':q' Enter    # quit
bind-key -T mobile o send-keys Escape ':wq' Enter   # save & quit

# TAB
bind-key -T mobile t send-keys Tab

# SPECIAL CHARACTERS
bind-key -T mobile g send-keys '`'          # backtick
bind-key -T mobile b send-keys '~'          # tilde

# TMUX - WINDOWS
bind-key -T mobile c new-window             # create window
bind-key -T mobile n next-window            # next window
bind-key -T mobile p previous-window        # prev window

# TMUX - PANES
bind-key -T mobile s split-window -h -c "#{pane_current_path}"  # split horizontal
bind-key -T mobile v split-window -v -c "#{pane_current_path}"  # split vertical
bind-key -T mobile h select-pane -L         # pane left
bind-key -T mobile j select-pane -D         # pane down
bind-key -T mobile k select-pane -U         # pane up
bind-key -T mobile l select-pane -R         # pane right

# COPY MODE
bind-key -T mobile y copy-mode              # enter copy/scroll mode

# HELP
bind-key -T mobile '?' display-popup -E -w 46 -h 26 '\
echo ""; \
echo "  ╔══════════════════════════════════════╗"; \
echo "  ║   SKIPPR KEYBINDINGS                 ║"; \
echo "  ║   Activate: .a  then letter          ║"; \
echo "  ╠══════════════════════════════════════╣"; \
echo "  ║  CONTROL         │  VIM              ║"; \
echo "  ║  i = Ctrl+C      │  e = Escape       ║"; \
echo "  ║  d = Ctrl+D      │  w = Save         ║"; \
echo "  ║  z = Ctrl+Z      │  q = Quit         ║"; \
echo "  ║  x = Clear       │  o = Save+Quit    ║"; \
echo "  ╠══════════════════════════════════════╣"; \
echo "  ║  NAVIGATE        │  SPECIAL          ║"; \
echo "  ║  a = Line start  │  g = Backtick     ║"; \
echo "  ║  f = Line end    │  b = Tilde ~      ║"; \
echo "  ║  r = Search      │  t = Tab          ║"; \
echo "  ╠══════════════════════════════════════╣"; \
echo "  ║  WINDOWS         │  PANES            ║"; \
echo "  ║  c = New window  │  s = Split horiz  ║"; \
echo "  ║  n = Next window │  v = Split vert   ║"; \
echo "  ║  p = Prev window │  hjkl = Navigate  ║"; \
echo "  ║                  │  y = Scroll mode  ║"; \
echo "  ╠══════════════════════════════════════╣"; \
echo "  ║  ? = This help                       ║"; \
echo "  ╚══════════════════════════════════════╝"; \
read -n 1'

# ABOUT - show ASCII tugboat  
bind-key -T mobile m display-popup -E -w 44 -h 16 '\
echo ""; \
echo "            ~  ~"; \
echo "       ~~~~     ~~~~"; \
echo "          |\\"; \
echo "          | \\"; \
echo "          |S \\"; \
echo "     _____|   \\____"; \
echo "    |             |_____"; \
echo "    | ○  SKIPPR   |     |~~"; \
echo "    |_____________|_____|"; \
echo "  ~~~~~~~~~~~~~~~~~~~~~~~~~~~"; \
echo ""; \
echo "           v0.0.1"; \
echo ""; \
echo "    Mobile Dev Environment"; \
echo ""; \
read -n 1'
