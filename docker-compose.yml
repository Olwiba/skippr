services:
  skippr:
    build: .
    container_name: skippr
    restart: unless-stopped

    ports:
      - "7681:7681"

    volumes:
      # Persistent project directory
      - skippr-projects:/home/dev/projects
      # Persistent Claude Code config and auth
      - skippr-claude:/home/dev/.claude

    environment:
      # Required: ttyd authentication
      - TTYD_USERNAME=${TTYD_USERNAME:-admin}
      - TTYD_PASSWORD=${TTYD_PASSWORD:-changeme}

      # Optional: Claude Code API Key
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}

      # Optional: Set timezone
      - TZ=${TZ:-UTC}

    # Coolify-compatible labels
    labels:
      - "coolify.managed=true"
      # IP Whitelist is configured in Coolify UI (Configuration > Network > Container Labels)
      # This prevents label override issues with docker-compose deployments

volumes:
  skippr-projects:
    driver: local
  skippr-claude:
    driver: local
